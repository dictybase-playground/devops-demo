import { Image, Split, themes } from "mdx-deck"
import prPageNoChecks from "./images/pr-page-no-checks.png"
import prPageChecks from "./images/pr-page-with-checks.png"
import prFail from "./images/pr-fail.png"

export const theme = themes.code

# DevOps at dictyBase

---

### Automate all the things!

<Image
  src="https://media0.giphy.com/media/1nR6fu93A17vWZbO9c/giphy.gif?cid=ecf05e471ltadedv5lb2jagb6c5ar91zqbxt6fbt5xweqfu5&rid=giphy.gif"
  height={450}
  width={710}
/>

---

## DevOps Process

1. Create Pull Request
2. Code Quality Control and Reports
3. Merge Code and Deploy

---

## Background Concepts

- Git branching model

<Split style={{ textAlign: "left", height: "auto" }}>
<center style={{ marginRight: "100px"}}>
  <Image
    src="https://nvie.com/img/main-branches@2x.png"
    height={402}
    width={267}
  />
</center>


<center>
  <Image src="https://nvie.com/img/fb@2x.png" height={357} width={133} />
</center>

</Split>


---

## Background Concepts

- Pull requests

<Image src={prPageNoChecks} height={600} width={620} />

---

## Code Quality Control

All of these run automatically:

- Linter
- Unit tests (with coverage)
- Build
- Visual testing (frontend)
- Performance testing (frontend)
- Code quality control checks

---

## Status Checks

<Image src={prPageChecks} height={1000} width={600} />

---

## Failed Checks

<Image src={prFail} height={304} width={600} />

---

## Merge Code

- Wait for status checks to pass
- Merge to `develop`
- Automerge minor library updates

---

# Deployment

- Automated: staging and prod
- Interactive: development

---

## New: ChatOps!

- `/deploy` command

---

## /deploy

Triggered from comments inside:

- Pull requests
- Issues

---

## Pull request example

- `/deploy cluster=erickube`
- `/deploy cluster=erickube commit=abc`

---

## Issue example

- `/deploy cluster=siddkube branch=develop`
- `/deploy cluster=siddkube commit=xyz`

---

## Prod and staging

- Automatically deployed using GitHub Actions

---

## The End

<Image
  src="https://media0.giphy.com/media/4TtTVTmBoXp8txRU0C/giphy.gif?cid=ecf05e471ltadedv5lb2jagb6c5ar91zqbxt6fbt5xweqfu5&rid=giphy.gif"
  height={379}
  width={710}
/>
